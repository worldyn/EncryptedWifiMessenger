#include "dh-params.h"
#include "machine_defs.h"

// TODO: Include Limb defs and whatnot.
// Make p, p_prim and g of type Limb[].


#ifdef DH_1024_A
/*
 * This is the 1048-bit MODP Group with 256-bit Prime Order Subgroup defined
 * in rfc5114 section 2.1.
 */

// They're 1024 bits (= 32 limbs = 128 bytes)
// So R = 2^1024, rlen = 32

Limb p[] = {
  0x2E4A4371,0xDF1FB2BC,0x6D4DA708,0xE68CFDA7,
  0x365C1A65,0x45BF37DF,0x0DC8B4BD,0xA151AF5F,
  0xF55BCCC0,0xFAA31A4F,0xE5644738,0x4EFFD6FA,
  0x219A7372,0x98488E9C,0x90C4BD70,0xACCBDD7D,
  0xD49B83BF,0x24975C3C,0xA9061123,0x13ECB4AE,
  0x2EE652C0,0x9838EF1E,0x75A23D18,0x6073E286,
  0x52D23B61,0x9A6A9DCA,0xFB06A3C6,0x52C99FBC,
  0xAE5D54EC,0xDE92DE5E,0xA080E01D,0xB10B8F96,
};

// Not from the doc but calculated based on p (and R).
// Chosen so that p*p_prim = -1 (mod R).
Limb p_prim[] = {
  0xFAF3E26F,0x75F08430,0x6D8FCF12,0xE8C5BA4B,
  0x9E264809,0xD351418A,0x9F8B9D41,0x6859D6BE,
  0xED66F277,0xC5437ADC,0xCDD683F4,0xBACB7C0B,
  0x94E36B0A,0x2C324F0F,0xAA2E9BA1,0x4FA8E2C1,
  0x9CA6DCBB,0x7DE571E6,0x24DD5717,0xDE25014D,
  0x543B8E37,0x2F0C55FA,0x2DB1FB0F,0x320EC939,
  0xA8B449B8,0x4205C15C,0x69554BC8,0x388BC4A8,
  0xC677C17B,0xAA37657A,0x91784AFA,0x51C8E809,
};

// No need for g itself.

// Montgomery form can be hardcoded.
Limb gm[] = {
  0x968DDE47,0x7A1846AB,0xA1AD8F09,0x4FCC9045,
  0x6E6D1091,0x50AB780B,0xD9967E0B,0x164DC400,
  0x4BF1B2C3,0xFFC0D1A6,0x712D9364,0x880A6E53,
  0xDAF4EC28,0xB95B2993,0xAF0DAB23,0xFE4B5DDE,
  0x141F2102,0x730795EC,0xFAB4398C,0xE908A407,
  0xBC883BA4,0xD1858221,0x6CE28B8E,0x1F3F785E,
  0x0CE6E0F6,0xB8A66448,0x791130B2,0xB60A1D09,
  0x818D85CC,0x21FAF94E,0x644E4B99,0x7310B332,
};

#endif // DH_1024_A


#ifdef DH_2048_A
/*
 * This is the 2048-bit MODP Group with 256-bit Prime Order Subgroup defined
 * in rfc5114 section 2.3.
 */

// They're 2048 bits (= 64 limbs = 256 bytes).
// So R = 2^2048, rlen = 64.

Limb p[] = {
  0x1E1A1597,0xDB094AE9,0xD7EF09CA,0x693877FA,
  0x6E11715F,0x6116D227,0xC198AF12,0xA4B54330,
  0xD7014103,0x75F26375,0x54E710C3,0xC3A3960A,
  0xBD0BE621,0xDED4010A,0x89962856,0xC0B857F6,
  0x71506026,0xB3CA3F79,0xE6B486F6,0x1CCACB83,
  0x14056425,0x67E144E5,0xA41825D9,0xF6A167B5,
  0x96524D8E,0x3AD83477,0x51BFA4AB,0xF13C6D9A,
  0x35488A0E,0x2D525267,0xCAA6B790,0xB63ACAE1,
  0x81B23F76,0x4FDB70C5,0x12307F5C,0xBC39A0BF,
  0xB1E59BB8,0xB941F54E,0xD45F9088,0x6C5BFC11,
  0x4275BF7B,0x22E0B1EF,0x5B4758C0,0x91F9E672,
  0x6BCF67ED,0x5A8A9D30,0x97517ABD,0x209E0C64,
  0x830E9A7C,0x3BF4296D,0x34096FAA,0x16C3D911,
  0x61B2AA30,0xFAF7DF45,0xD61957D4,0xE00DF8F1,
  0x435E3B00,0x5D2CEED4,0x660DD0F2,0x8CEEF608,
  0x65195999,0xFFBBD19C,0xB4B6663C,0x87A8E61D,
};

// Not from the doc but calculated based on p (and R).
// Chosen so that p*p_prim = -1 (mod R).
Limb p_prim[] = {
  0xC2BE45D9,0x51EA7EF0,0xA8CEF409,0x6C79A66B,
  0xDE53E27A,0x37810666,0x775002CD,0x9B340F64,
  0x9E99BDC7,0xEC5C6041,0xBDD62216,0xA3A9438E,
  0x491295D6,0x90BA2652,0x1EB31674,0xBB6EA0A5,
  0x9A9B67EC,0xA1B46AB7,0x45E2D54D,0x9B2B1750,
  0xEFF6CEA0,0x97586EF5,0x12439D2F,0x5F961C62,
  0x1362FCB9,0x1F46E8CD,0xF482295C,0x8D15102A,
  0xC33F2B4C,0x6DF8F667,0x207528F6,0xD560C958,
  0x894063B5,0x4771E5A0,0x9498A622,0x545FBC2E,
  0x03FD2E51,0x9F60FF2A,0xDA623BF4,0x7B327EFC,
  0x31F9A118,0x5BE63C9D,0x2A96339D,0xF9D89872,
  0xE648331D,0x2EA2D096,0x04E9B8DD,0x3F3AF3B4,
  0xC81432BD,0x692A2064,0x73F7CFCC,0xC02B9317,
  0x020A74AF,0xAC68B876,0xF243A710,0xB4FB62CC,
  0x4ED53DC7,0xBC44DBA6,0x116853B1,0xCA6E7ED0,
  0xFAE48FAE,0xA64FAF23,0x5430E1C0,0x8E494FD3,
};

// No need for g itself.
/*
Limb g[] = {
  0x6CC41659,0x664B4C0F,0xEF98C582,0x5E2327CF,
  0xD4795451,0xD647D148,0x90F00EF8,0x2F630784,
  0x1DB246C3,0x184B523D,0xCDC67EB6,0xC7891428,
  0x0DF92B52,0x7FD02837,0x64E0EC37,0xB3353BBB,
  0x57CD0915,0xECD06E15,0xDF016199,0xB7D2BBD2,
  0x052588B9,0xC8484B1E,0x13D3FE14,0xDB2A3B73,
  0xD182EA0A,0xD052B985,0xE83B9C80,0xA4BD1BFF,
  0xFB3F2E55,0xDFC967C1,0x767164E1,0xB5045AF2,
  0x6F2F9193,0x1D14348F,0x428EBC83,0x64E67982,
  0x82D6ED38,0x8AC376D2,0xAAB8A862,0x777DE62A,
  0xE9EC144B,0xDDF463E5,0xC77A57F2,0x0196F931,
  0x41000A65,0xA55AE313,0xC28CBB18,0x901228F8,
  0x7E8C6F62,0xBC3773BF,0x0C6B47B1,0xBE3A6C1B,
  0xAC0BB555,0xFF4FED4A,0x77BE463F,0x10DBC150,
  0x1A0BA125,0x07F4793A,0x21EF2054,0x4CA7B18F,
  0x60EDBD48,0x2E775066,0x73134D0B,0x3FB32C9B,
};
*/

// Montgomery form can be hardcoded.
Limb gm[] = {
  0xdd02137b,0x855867b7,0x1dc014b8,0x97935773,
  0xf3e9bbb7,0xefab85e5,0xeb4083d5,0x9b083fee,
  0x78b71b4b,0x8bbe9087,0x6b97d36d,0x2047dc93,
  0x409e465c,0x5fdbf24b,0x66b9ab27,0x0b88b30e,
  0xc9b96e35,0x3f9d9ade,0xba87d681,0xd5dcd8a5,
  0xc23d607d,0x9b4a48f0,0x40202d9e,0xe142068c,
  0x3e1f5aaa,0xd53ec711,0xab158c7e,0xd7e036da,
  0x26655c18,0x5618b2c3,0xaf9e8eb8,0x85ebfc2e,
  0x11f857a3,0xd0206722,0x0caef3e8,0x4fcd3397,
  0xb0e7e88b,0xd09f9ae2,0x06848c6b,0x993eef59,
  0xb75c1f5c,0xcece514f,0x97ac83ca,0x26adfdf9,
  0x91b3e7ce,0x8cf0a481,0xc74e502a,0x8f618286,
  0x6f20f1db,0xd3f30287,0xf054f2e2,0xc914e626,
  0xd04dc1c0,0xdb2cfce5,0xad2021da,0x79f1ee6c,
  0x8f2c0431,0x7caa02c0,0xae940e21,0xd9509c11,
  0xd7d9bd95,0x09af70d9,0xa81c2ac0,0x27dca8c5,
};

#endif // DH_2048_A

const MontgomeryCtx mctx = {
  .rlen = R_LEN,
  .nlen = R_LEN,
  .n    = p,
  .np   = p_prim
};


